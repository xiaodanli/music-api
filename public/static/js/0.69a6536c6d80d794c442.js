webpackJsonp([0],{B9xq:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("Dd8w"),a=i.n(s),n=i("2bvH"),l={data:function(){return{musicList:[],total:0,pagenum:1,limit:2,dialogVisible:!1,music:{music_name:"",singer_name:"",pic:"",isup:"1"},editId:"",rules:{music_name:[{required:!0,message:"请输入歌名",trigger:"blur"}],singer_name:[{required:!0,message:"请输入歌手",trigger:"blur"}],pic:[{required:!0,message:"请选择图片",trigger:"blur"}]},isDel:!1,delId:""}},created:function(){var e=this;this.getList(),this.$api.user.getInfo().then(function(t){1===t.data.code&&e.setName(t.data.data.username)})},computed:a()({},Object(n.c)({username:function(e){return e.user.username}})),methods:a()({},Object(n.b)("user",["setName"]),{handleCurrentChange:function(e){this.pagenum=e,this.getList()},getList:function(){var e=this;this.$api.music.getList({pagenum:this.pagenum,limit:this.limit}).then(function(t){1===t.data.code&&(e.musicList=t.data.data,e.total=t.data.total)})},quit:function(){window.localStorage.removeItem("token"),this.$router.push("/login")},upload:function(e){var t=this,i=e.target.files,s=new FormData;s.append("file",i[0]),this.$api.music.upload(s).then(function(e){1===e.data.code&&(t.music.pic="http://localhost:3000"+e.data.url)})},reset:function(){this.music={music_name:"",singer_name:"",isup:"1",pic:""}},add:function(){var e=this;this.$refs.ruleForm.validate(function(t){t&&(e.editId?e.$api.music.edit(a()({},e.music,{id:e.editId})).then(function(t){if(1===t.data.code){e.$message({message:"修改",type:"success"}),e.dialogVisible=!1;var i=e.musicList.findIndex(function(t){return t.id===e.editId});e.musicList.splice(i,1,a()({},e.music,{id:e.editId})),e.reset()}}):e.$api.music.add(e.music).then(function(t){1===t.data.code?(e.$message({message:"歌曲成功",type:"success"}),e.dialogVisible=!1,e.getList()):2===t.data.code?e.$message({message:"该歌曲已经添加",type:"warning"}):e.$message({message:"添加失败",type:"error"}),e.reset()}))})},edit:function(e){var t=this.musicList.find(function(t){return t.id===e});this.dialogVisible=!0,this.music.music_name=t.music_name,this.music.singer_name=t.singer_name,this.music.isup=t.isup,this.music.pic=t.pic,this.editId=t.id},del:function(){var e=this;this.$api.music.del({id:this.delId}).then(function(t){1===t.data.code&&(e.$message({message:"删除成功",type:"success"}),e.getList(),e.isDel=!1)})},openDelDialog:function(e){this.isDel=!0,this.delId=e}})},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{staticClass:"music-wrap"},[i("el-header",[i("span",[e._v("欢迎:"+e._s(e.username))]),e._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:e.quit}},[e._v("退出")])],1),e._v(" "),i("el-container",[i("el-aside",{attrs:{width:"200px"}},[e._v("音乐列表")]),e._v(" "),i("el-main",[i("el-button",{on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加")]),e._v(" "),i("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.musicList}},[i("el-table-column",{attrs:{label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[e._v("\n                            "+e._s(t.$index+1)+"\n                        ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"歌名",prop:"music_name"}}),e._v(" "),i("el-table-column",{attrs:{label:"歌手",prop:"singer_name"}}),e._v(" "),i("el-table-column",{attrs:{label:"图片",prop:"pic"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("img",{staticStyle:{width:"80px",height:"80px"},attrs:{src:e.row.pic,alt:""}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"是否上架",prop:"isup"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[e._v("\n                            "+e._s("1"===t.row.isup?"上架":"下架")+"\n                        ")])]}}])}),e._v(" "),i("el-table-column",{scopedSlots:e._u([{key:"header",fn:function(t){return[e._v("\n                        操作\n                    ")]}},{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.edit(t.row.id)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.openDelDialog(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":2},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.reset}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.music,"status-icon":"",rules:e.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"歌名",prop:"music_name"}},[i("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.music.music_name,callback:function(t){e.$set(e.music,"music_name",t)},expression:"music.music_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"歌手",prop:"singer_name"}},[i("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.music.singer_name,callback:function(t){e.$set(e.music,"singer_name",t)},expression:"music.singer_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"上传图片",prop:"pic"}},[i("input",{attrs:{type:"file"},on:{change:e.upload}}),e._v(" "),i("img",{staticStyle:{width:"80px",height:"80px"},attrs:{src:e.music.pic,alt:""}})]),e._v(" "),i("el-form-item",{attrs:{label:"是否上架",prop:"isup"}},[i("el-radio-group",{model:{value:e.music.isup,callback:function(t){e.$set(e.music,"isup",t)},expression:"music.isup"}},[i("el-radio",{attrs:{label:"1"}},[e._v("是")]),e._v(" "),i("el-radio",{attrs:{label:"0"}},[e._v("否")])],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("保存")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"提示",visible:e.isDel,width:"30%",center:""},on:{"update:visible":function(t){e.isDel=t}}},[i("span",[e._v("是否要删除此歌曲？")]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.isDel=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.del}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var u=i("VU/8")(l,r,!1,function(e){i("wR23")},"data-v-a13e5d9c",null);t.default=u.exports},wR23:function(e,t){}});
//# sourceMappingURL=0.69a6536c6d80d794c442.js.map